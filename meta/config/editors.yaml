# -------------- Install software
- ifubuntu:
    - shell:
        - "curl -fsSL https://deb.nodesource.com/setup_16.x | sudo bash -"
        - "curl -sL https://dl.yarnpkg.com/debian/pubkey.gpg | gpg --dearmor | sudo tee /usr/share/keyrings/yarnkey.gpg >/dev/null"
        - "echo 'deb [signed-by=/usr/share/keyrings/yarnkey.gpg] https://dl.yarnpkg.com/debian stable main' | sudo tee /etc/apt/sources.list.d/yarn.list"
        - "sudo apt update"

    - apt:
        - git
        - neovim
        - vim-nox
        - global
        - exuberant-ctags
        - libclang-dev
        - clangd
        - nodejs
        - yarn
        - build-essential

- ifarch:
    - pacman:
        - neovim
        - vim
        - global
        - ctags
        - clang
        - nodejs
        - yarn
        - base-devel

- ifmacos:
    - brew:
        - git
        - neovim
        - global
        - ctags
        - node
        - yarn

- pip:
    file: meta/config/requirements.txt
    user: true
    stdout: false
    stderr: true

- yarn:
    stdout: false
    stderr: true
    packages:
      - remark  # Spacevim layer lang#markdown
      - remark-cli  # Spacevim layer lang#markdown
      - remark-stringify  # Spacevim layer lang#markdown
      - remark-frontmatter  # Spacevim layer lang#markdown
      - wcwidth  # Spacevim layer lang#markdown
      - prettier  # Spacevim layer lang#markdown, neoformat (several filetypes)
      - vscode-html-languageserver-bin  # Spacevim layer lang#html
      - bash-language-server  # Spacevim layer language_server_protocol
      - dockerfile-language-server-nodejs  # Spacevim layer lang#dockerfile

- create:
    - ~/.local/share/nvim/shada/

- shell:
    - ['curl --proto "=https" --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --no-modify-path --profile minimal', 'Installing Rust']
    - ['. ~/.cargo/env && rustup component add rls rust-analysis rust-src', 'Adding RLS']
    - ['touch ~/.local/share/nvim/shada/main.shada', 'TODO FIX NVIM THROWS ERRORS ON STARTUP']
    - ["curl -sLf https://spacevim.org/install.sh | bash -s -- --no-fonts", "Installing SpaceVim"]

# -------------- Link configuration
- link:
    ~/.ideavimrc: editors/ideavimrc
    ~/.editorconfig: editors/editorconfig
    ~/.SpaceVim.d: editors/SpaceVim.d
    ~/.SpaceVim/coc-settings.json: editors/coc-settings.json

- shell:
    - ["nvim --headless +'call dein#install()' +UpdateRemotePlugins +qall", "Install VIM Plugins"]
    - ["nvim --headless +'CocInstall -sync coc-clangd coc-rls coc-pyright' +qall", "Install Coc Extensions"]
