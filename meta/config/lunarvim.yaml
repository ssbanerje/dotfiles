# --- LunarVim Configuration ---
- ifubuntu:
    - shell:
        - ["curl -fsSL https://deb.nodesource.com/setup_16.x | sudo bash -", "Add NodeJS PPA"]
        - ["sudo add-apt-repository ppa:neovim-ppa/unstable", "Add Neovim PPA"]  # TODO FIX THIS
        - "sudo apt-get update"
    - apt:
        - neovim
        - nodejs
        - unzip
        - rsync
        - shellcheck
        - ripgrep
        - fd-find

- ifarch:
    - pacman:
        - neovim
        - nodejs
        - npm
        - unzip
        - rsync
        - shellcheck
        - ripgrep
        - fd

- ifmacos:
    - brew:
        - neovim
        - node
        - unzip
        - rsync
        - shellcheck
        - ripgrep
        - fd

- shell:
    - ["mkdir -p ~/.npm_global", "Setup NPM Global"]
    - ["npm config set prefix '~/.npm-global'", "Setup NPM Global"]

- pip:
    file: editors/lvim-config/requirements.txt
    user: true
    stdout: false
    stderr: true

- npm:
    stdout: false
    stderr: true
    packages:
      - neovim
      - tree-sitter-cli

- shell:
    - ["curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --no-modify-path --profile minimal", "Installing Rust"]
    - [". ~/.cargo/env && rustup component add rust-src", "Adding Rust Source"]
    - ["LV_BRANCH=rolling curl -LSs https://raw.githubusercontent.com/lunarvim/lunarvim/rolling/utils/installer/install.sh | bash -s -- --no-install-dependencies", "Installing Lunarvim"]

- create:
  - ~/.config/lvim

- link:
    ~/.editorconfig: editors/editorconfig
    ~/.config/lvim/config.lua: editors/lvim-config/config.lua
    ~/.config/lvim/lua: editors/lvim-config/lua

- shell:
    - ["~/.local/bin/lvim --headless +'TSInstallSync all' +qall", "Install lvim-TreeSitter Plugins"]
    - ["~/.local/bin/lvim --headless -c 'autocmd User PackerComplete quitall' -c 'PackerSync'", "Install lvim-Packer Plugins"]
